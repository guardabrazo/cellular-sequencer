:root {
  /* Dark Theme (Default) */
  --bg-color: #050505;
  --grid-color: #1a1a1a;
  --cell-inactive: #111;
  --cell-active: #fff;
  --cell-highlight: #444;
  --accent: #fff;
  --text-color: #eee;
  --text-muted: #888;
  --border-color: #333;
  --border-color-light: #666;
  --border-color-highlight: #fff;
  --button-bg: transparent;
  --button-text: #fff;
  --button-hover-bg: #fff;
  --button-hover-text: #000;
  --input-bg: transparent;
  --input-text: #fff;
  --slider-track: #333;
  --slider-thumb: #fff;
  --font-main: 'Helvetica Neue', 'Arial', sans-serif;
  --grid-dot-color: rgba(255, 255, 255, 0.03);
}

[data-theme='light'] {
  /* Light Theme */
  --bg-color: #f4f4f4;
  --grid-color: #e0e0e0;
  --cell-inactive: #fff;
  --cell-active: #000;
  --cell-highlight: #ddd;
  --accent: #000;
  --text-color: #111;
  --text-muted: #666;
  --border-color: #ccc;
  --border-color-light: #999;
  --border-color-highlight: #000;
  --button-bg: transparent;
  --button-text: #000;
  --button-hover-bg: #000;
  --button-hover-text: #fff;
  --input-bg: transparent;
  --input-text: #000;
  --slider-track: #ccc;
  --slider-thumb: #000;
  --grid-dot-color: rgba(0, 0, 0, 0.05);
}

body {
  margin: 0;
  padding: 0;
  background-color: var(--bg-color);
  color: var(--text-color);
  font-family: var(--font-main);
  overflow: hidden;
  user-select: none;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: crosshair;
  /* Stylish crosshair cursor */
}

#root {
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.sequencer-container {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 2rem;
  border: 1px solid var(--border-color);
  position: relative;
  max-width: 95vw;
  background:
    linear-gradient(90deg, var(--grid-dot-color) 1px, transparent 1px),
    linear-gradient(var(--grid-dot-color) 1px, transparent 1px);
  background-size: 20px 20px;
  /* Subtle grid background */

  &::before,
  &::after {
    content: '';
    position: absolute;
    width: 10px;
    height: 10px;
    border: 1px solid var(--border-color-highlight);
    transition: all 0.2s ease;
  }

  &::before {
    top: -1px;
    left: -1px;
    border-right: none;
    border-bottom: none;
  }

  &::after {
    bottom: -1px;
    right: -1px;
    border-left: none;
    border-top: none;
  }
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
  width: 100%;

  .header-left {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 0.6rem;
    color: var(--text-muted);
  }

  h1 {
    font-size: 0.9rem;
    letter-spacing: 4px;
    margin: 0;
    font-weight: normal;
    /* Not bold */
    color: var(--text-color);
  }

  .crosshair {
    width: 15px;
    height: 15px;
    border: 1px solid var(--border-color-light);
    border-radius: 50%;
    position: relative;

    &::before,
    &::after {
      content: '';
      position: absolute;
      background: var(--border-color-light);
    }

    &::before {
      top: 50%;
      left: -4px;
      right: -4px;
      height: 1px;
      transform: translateY(-50%);
    }

    &::after {
      left: 50%;
      top: -4px;
      bottom: -4px;
      width: 1px;
      transform: translateX(-50%);
    }
  }

  .badge {
    border: 1px solid var(--border-color-highlight);
    border-radius: 10px;
    padding: 2px 8px;
    font-size: 0.5rem;
    color: var(--text-color);
  }
}

.decorative-line {
  width: 100%;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--border-color), transparent);
  margin-bottom: 0.5rem;
}

.grid {
  display: grid;
  grid-template-columns: repeat(32, 1fr);
  gap: 2px;
}

.cell {
  width: 24px;
  /* Increased cell size */
  height: 24px;
  background-color: var(--cell-inactive);
  border: 1px solid var(--border-color);
  cursor: crosshair;
  /* Consistent cursor */
  /* transition: background-color 0.1s, transform 0.1s; */
  /* Removed to prevent glitches */

  &:hover {
    border-color: var(--border-color-light);
  }

  &.active {
    background-color: var(--cell-active);
    box-shadow: 0 0 5px rgba(var(--cell-active), 0.5);
  }

  &.current-step {
    border-color: var(--border-color-highlight);
    transform: scale(1.1);
    z-index: 1;
  }

  &.frozen {
    opacity: 0.4;
  }
}

.controls {
  display: flex;
  gap: 2rem;
  align-items: flex-start;
  justify-content: space-between;
  width: 100%;
  flex-wrap: wrap;

  .section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;

    h3 {
      font-size: 0.6rem;
      margin: 0;
      opacity: 0.8;
      letter-spacing: 1px;
      font-weight: normal;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 2px;
      margin-bottom: 4px;
      width: 100%;
      color: var(--text-color);
    }

    .row {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
  }

  button {
    background: var(--button-bg);
    border: 1px solid var(--button-text);
    color: var(--button-text);
    padding: 0.4rem 0.8rem;
    font-family: var(--font-main);
    cursor: crosshair;
    /* Consistent cursor */
    text-transform: uppercase;
    font-size: 0.7rem;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;

    &:hover {
      background: var(--button-hover-bg);
      color: var(--button-hover-text);
    }

    &.active {
      background: var(--button-hover-bg);
      color: var(--button-hover-text);
    }
  }

  .slider-group {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;

    label {
      font-size: 0.6rem;
      text-transform: uppercase;
      opacity: 0.7;
      color: var(--text-color);
    }

    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 80px;
      height: 2px;
      background: var(--slider-track);
      outline: none;
      cursor: crosshair;

      &::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 8px;
        height: 8px;
        background: var(--slider-thumb);
        cursor: crosshair;
      }
    }
  }

  select {
    background: var(--input-bg);
    color: var(--input-text);
    border: 1px solid var(--border-color);
    padding: 0.3rem;
    font-family: var(--font-main);
    font-size: 0.7rem;
    text-transform: uppercase;
    outline: none;
  }
}

.track-labels {
  display: grid;
  grid-template-rows: repeat(8, 1fr);
  gap: 2px;
  margin-right: 10px;

  .track-row {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 5px;

    .label {
      font-size: 0.6rem;
      opacity: 0.5;
      width: 40px;
      text-align: right;
      color: var(--text-color);
    }

    .track-btn {
      width: 16px;
      height: 16px;
      font-size: 0.5rem;
      border: 1px solid var(--border-color);
      background: transparent;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: crosshair;
      padding: 0;

      &:hover {
        border-color: var(--border-color-light);
      }

      &.active {
        background: var(--button-hover-bg);
        color: var(--button-hover-text);
      }

      &.solo.active {
        background: var(--button-hover-bg);
        color: var(--button-hover-text);
      }

      &.mute.active {
        background: var(--button-hover-bg);
        color: var(--button-hover-text);
        text-decoration: line-through;
      }
    }
  }
}

.main-layout {
  display: flex;
  flex-direction: row;
}

.freeze-controls {
  display: grid;
  grid-template-rows: repeat(8, 1fr);
  gap: 2px;
  margin-left: 10px;

  .freeze-row {
    display: flex;
    align-items: center;
    justify-content: flex-start;

    .freeze-btn {
      width: 16px;
      height: 16px;
      font-size: 0.5rem;
      border: 1px solid var(--border-color);
      background: transparent;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: crosshair;
      padding: 0;

      &:hover {
        border-color: var(--border-color-light);
      }

      &.active {
        background: var(--button-hover-bg);
        color: var(--button-hover-text);
      }
    }
  }
}

.aesthetic-footer {
  display: flex;
  justify-content: space-between;
  width: 100%;
  margin-top: 1rem;
  border-top: 1px solid var(--border-color);
  padding-top: 1rem;
  font-family: 'Helvetica Neue', sans-serif;
  /* Strict sans */
  font-size: 0.6rem;
  letter-spacing: 1px;
  color: var(--text-muted);

  .footer-block {
    display: flex;
    gap: 1.5rem;
    align-items: flex-start;
  }

  .box-border {
    border: 1px solid var(--border-color-highlight);
    padding: 2px 6px;
    color: var(--text-color);
    font-weight: normal;
    /* Was bold, user requested not "black" (likely bold) */
    display: flex;
    align-items: center;
    gap: 5px;

    &::before {
      content: 'â†‘';
      /* Arrow icon simulation */
      font-size: 0.8rem;
    }
  }

  .text-group {
    display: flex;
    flex-direction: column;
    gap: 2px;

    p {
      margin: 0;
      color: var(--text-muted);
    }

    p:first-child {
      color: var(--text-color);
    }
  }

  .dimensions {
    display: flex;
    flex-direction: column;
    border-left: 1px solid var(--border-color-highlight);
    padding-left: 10px;

    span {
      line-height: 1.2;
      color: var(--text-muted);
    }
  }

  .logos {
    display: flex;
    flex-direction: column;
    text-align: right;
    border-left: 1px solid var(--border-color);
    /* Separator */
    padding-left: 10px;

    span {
      line-height: 1.2;
    }
  }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .sequencer-container {
    padding: 1rem;
    max-width: 100vw;
    border: none;
    height: 100vh;
    justify-content: center;
  }

  .header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;

    .header-right {
      width: 100%;
      justify-content: space-between;
    }
  }

  .main-layout {
    width: 100%;
    overflow: hidden;
    /* Contain the scroll */
  }

  .track-labels {
    flex-shrink: 0;
    /* Don't shrink labels */
    z-index: 10;
    background: var(--bg-color);
    /* Cover scrolling grid */
  }

  .grid {
    overflow-x: auto;
    display: grid;
    /* Ensure grid layout persists */
    padding-bottom: 10px;
    /* Space for scrollbar */

    /* Custom scrollbar for webkit */
    &::-webkit-scrollbar {
      height: 4px;
    }

    &::-webkit-scrollbar-track {
      background: var(--cell-inactive);
    }

    &::-webkit-scrollbar-thumb {
      background: var(--cell-highlight);
    }
  }

  /* Wrap grid in a scrollable container if needed, 
     but since grid is a direct child of flex, we might need a wrapper in JSX 
     OR just set overflow on the grid itself if it has a fixed width content.
     Actually, grid-template-columns: repeat(32, 1fr) will try to fit in screen.
     We need to force min-width on cells or grid to trigger scroll.
  */
  .grid {
    grid-template-columns: repeat(32, 30px);
    /* Fixed width cells on mobile to force scroll */
    width: 100%;
    overflow-x: scroll;
  }

  /* We need to make the grid container scrollable, not the grid itself if it's 1fr.
     But changing to fixed px columns works. 
     However, the track labels are separate. 
     If we scroll the grid, the rows might misalign if we are not careful.
     Actually, .grid is the container of cells. 
     If .grid scrolls, the labels (which are outside) stay put. This is what we want.
  */

  .aesthetic-footer {
    flex-direction: column;
    gap: 1rem;

    .footer-block {
      flex-direction: column;
      gap: 1rem;
      width: 100%;
    }

    .logos {
      text-align: left;
      border-left: none;
      padding-left: 0;
      border-top: 1px solid var(--border-color);
      padding-top: 10px;
      width: 100%;
    }

    .dimensions {
      border-left: none;
      padding-left: 0;
      border-top: 1px solid var(--border-color-highlight);
      padding-top: 10px;
      width: 100%;
    }
  }

  .controls {
    gap: 1rem;
    justify-content: flex-start;

    .section {
      width: 100%;
      /* Full width controls */
    }

    .row {
      flex-wrap: wrap;
    }
  }
}